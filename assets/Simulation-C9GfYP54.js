import{u as $,a as T,r as n,A as a,j as e,S as p,B as f}from"./index-2SbSSxvb.js";import{C as z}from"./Card-C2ecZoks.js";const A=()=>{const{companies:r,selectedCompanyIds:d,setSelectedCompanyIds:j,toggleCompanySelection:v,runSimulation:N,aiStatus:l,simulationReport:y,setSimulationReport:w,simulationProgress:h,progressLogs:b,reportPreviewText:x}=$(),{navigate:S}=T(),[m,C]=n.useState(""),[o,u]=n.useState(1),c=n.useRef(null),i=l!==a.Ready&&l!==a.Completed,k=l===a.Simulating_SynthesizingReport||y!==null;n.useEffect(()=>{c.current&&l===a.Simulating_SynthesizingReport&&(c.current.scrollTop=c.current.scrollHeight)},[x,l]);const R=s=>{let t=0;l===a.PolicyParsing&&(t=1),l===a.DnaLoading&&(t=2),l===a.Simulating_RunningTurns&&(t=3),l===a.Simulating_Aggregation&&(t=4),l===a.Simulating_SynthesizingReport&&(t=5),l===a.Completed&&(t=6);const g=s+1;return t>g?"done":t===g?"process":"wait"},_=[{title:"è¯»å–æ”¿ç­–",index:0},{title:"è¯»å–ç”»åƒ",index:1},{title:"æ‰§è¡Œä»¿çœŸ",index:2},{title:"åˆ†ææ±‡æ€»",index:3},{title:"ç”ŸæˆæŠ¥å‘Š",index:4}];if(n.useEffect(()=>{d.length===0&&r.length>0&&j(r.map(s=>s.id))},[r]),k){const s=l===a.Simulating_SynthesizingReport;return e.jsxs("div",{className:"space-y-6 animate-fade-in h-[calc(100vh-140px)] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded-lg shadow-sm border border-slate-200 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:s?"ä»¿çœŸç»“æœç”Ÿæˆä¸­...":"ä»¿çœŸæ–‡æœ¬é¢„è§ˆ"}),s&&e.jsxs("span",{className:"bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full flex items-center animate-pulse",children:[e.jsx(p,{size:"sm",className:"mr-1"})," Polaris AI æ’°å†™ä¸­"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>{w(null)},className:`text-sm ${s?"text-gray-400 cursor-not-allowed":"text-gray-600 hover:text-gray-900"}`,disabled:s,children:"â† é‡ç½®å¹¶è¿”å›é…ç½®"}),e.jsx(f,{onClick:()=>S("simulation-result"),disabled:s,variant:"primary",className:"shadow-md",children:"æŸ¥çœ‹æ”¿ç­–æŠ¥å‘Š â†’"})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden bg-white rounded-lg shadow-lg border border-slate-200 relative",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"h-10 bg-slate-50 border-b border-slate-200 flex items-center px-4 space-x-2 flex-shrink-0",children:[e.jsxs("div",{className:"flex space-x-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-400"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400"})]}),e.jsx("div",{className:"h-4 w-px bg-slate-300 mx-2"}),e.jsx("div",{className:"text-xs text-slate-500 font-mono",children:"polaris_report_stream.md"}),e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"text-xs font-mono",children:s?e.jsx("span",{className:"text-blue-600 animate-pulse",children:"â— Receiving Stream..."}):e.jsx("span",{className:"text-green-600",children:"â— Completed"})})]}),e.jsx("div",{ref:c,className:"flex-1 p-8 overflow-y-auto font-mono text-sm leading-relaxed text-slate-800 bg-white relative",children:x?e.jsxs("div",{className:"whitespace-pre-wrap max-w-4xl mx-auto pb-20",children:[x,s&&e.jsx("span",{className:"inline-block w-2.5 h-5 bg-blue-600 ml-1 animate-pulse align-text-bottom"})]}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-slate-100 rounded w-3/4 mb-8"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-slate-100 rounded w-full"}),e.jsx("div",{className:"h-4 bg-slate-100 rounded w-11/12"}),e.jsx("div",{className:"h-4 bg-slate-100 rounded w-full"})]}),e.jsx("div",{className:"h-64 bg-slate-50 rounded border border-dashed border-slate-200 flex items-center justify-center text-slate-400 text-sm",children:"æ­£åœ¨ç»¼åˆåšå¼ˆæ•°æ®ä¸å› æœå½’å› ..."})]})})]})})]})}return e.jsx("div",{className:"space-y-6 animate-fade-in relative",children:e.jsx(z,{title:"æ”¿ç­–ä»¿çœŸæ²™ç›˜",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["1. é€‰æ‹©å‚æ¼”ä¼ä¸š (",d.length,"/",r.length,")"]}),e.jsx("div",{className:"border rounded-md p-3 bg-slate-50 h-40 overflow-y-auto grid grid-cols-1 sm:grid-cols-2 gap-2",children:r.length===0?e.jsx("div",{className:"col-span-2 text-center text-gray-400 text-sm py-10",children:"æš‚æ— ä¼ä¸šï¼Œè¯·å…ˆå»æ•°æ®å½•å…¥æ·»åŠ "}):r.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-slate-100 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:d.includes(s.id),onChange:()=>v(s.id),disabled:i,className:"rounded text-slate-900 focus:ring-slate-900 disabled:opacity-50"}),e.jsx("span",{className:`text-sm truncate ${i?"text-gray-400":"text-slate-700"}`,children:s.name})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"2. ä»¿çœŸæ·±åº¦é…ç½® (è½®æ¬¡)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("button",{onClick:()=>u(1),disabled:i,className:`px-3 py-2 rounded border text-sm font-medium transition-colors ${o===1?"bg-blue-100 border-blue-500 text-blue-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:"ğŸš€ å¿«é€Ÿé¢„è§ˆ (1è½®)"}),e.jsx("button",{onClick:()=>u(2),disabled:i,className:`px-3 py-2 rounded border text-sm font-medium transition-colors ${o===2?"bg-blue-100 border-blue-500 text-blue-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:"âš–ï¸ æ ‡å‡†æ¨æ¼” (2è½®)"}),e.jsx("button",{onClick:()=>u(3),disabled:i,className:`px-3 py-2 rounded border text-sm font-medium transition-colors ${o===3?"bg-blue-100 border-blue-500 text-blue-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:"ğŸ§  æ·±åº¦åšå¼ˆ (3è½®)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"* æ¨èä½¿ç”¨â€œå¿«é€Ÿé¢„è§ˆâ€ä»¥èŠ‚çœ Token å¹¶è·å¾—å³æ—¶åé¦ˆã€‚æ·±åº¦åšå¼ˆè€—æ—¶è¾ƒé•¿ã€‚"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"3. è¾“å…¥æ”¿ç­–æ–‡æœ¬"}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded p-3 text-sm h-32 focus:outline-none focus:ring-2 focus:ring-slate-500 disabled:bg-gray-100",placeholder:"åœ¨æ­¤å¤„ç²˜è´´æ”¿ç­–æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼š'å¯¹ä½¿ç”¨å›½äº§æ¶²æ°§ç”²çƒ·å‘åŠ¨æœºçš„ä¼ä¸šæä¾›2000ä¸‡å…ƒè¡¥è´´...'",value:m,onChange:s=>C(s.target.value),disabled:i})]})]}),e.jsxs("div",{className:"flex-1 border-l border-gray-200 pl-8 flex flex-col relative",children:[e.jsx("h4",{className:"font-bold text-lg mb-6 text-slate-800",children:"ä»¿çœŸæ§åˆ¶å°"}),e.jsxs("div",{className:"relative flex justify-between mb-8",children:[e.jsx("div",{className:"absolute top-3 left-0 right-0 h-0.5 bg-slate-200 -z-10"}),_.map(s=>{const t=R(s.index);return e.jsxs("div",{className:"flex flex-col items-center bg-white px-1",children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold transition-colors duration-500 ${t==="done"?"bg-green-500 text-white":t==="process"?"bg-blue-600 text-white ring-4 ring-blue-100":"bg-slate-200 text-slate-400"}`,children:t==="done"?"âœ“":s.index+1}),e.jsx("span",{className:`text-[10px] sm:text-xs mt-2 text-center whitespace-nowrap ${t==="process"?"text-blue-600 font-bold":"text-gray-500"}`,children:s.title})]},s.index)})]}),e.jsx("div",{className:"bg-slate-900 rounded-lg p-4 font-mono text-xs h-64 overflow-y-auto mb-4 flex flex-col-reverse",children:i||l===a.Completed?e.jsxs(e.Fragment,{children:[b.length===0&&e.jsx("span",{className:"text-slate-500",children:"ç­‰å¾…å¼€å§‹..."}),b.map((s,t)=>e.jsxs("div",{className:"mb-1 border-l-2 border-blue-500 pl-2 animate-fade-in",children:[e.jsxs("span",{className:"text-blue-400",children:["[",new Date().toLocaleTimeString(),"]"]})," ",e.jsx("span",{className:"text-gray-300",children:s})]},t))]}):e.jsx("div",{className:"flex items-center justify-center h-full text-slate-500",children:"ç³»ç»Ÿå°±ç»ªï¼Œç­‰å¾…æŒ‡ä»¤"})}),i&&e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2 mb-4",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${h}%`}})}),e.jsx("div",{className:"mt-auto",children:e.jsx(f,{className:"w-full bg-slate-900 text-white h-12 text-lg disabled:bg-slate-300 disabled:cursor-not-allowed shadow-md",onClick:()=>N(m,o),disabled:i||!m||d.length===0,children:i?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"mr-2 text-white"})," è®¡ç®—ä¸­ (",Math.round(h),"%)..."]}):"å¼€å§‹è¿è¡Œä»¿çœŸ"})})]})]})})})};export{A as Simulation};
